<div class="flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-100">
  <!-- Floating background elements -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-10 left-10 w-72 h-72 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob"></div>
    <div class="absolute top-40 right-10 w-72 h-72 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000"></div>
    <div class="absolute -bottom-8 left-1/2 w-72 h-72 bg-pink-200 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000"></div>
  </div>

  <mat-card class="w-full max-w-md shadow-2xl relative z-10 transform hover:shadow-3xl transition-all duration-500 backdrop-blur-sm bg-white/95" 
    [class.card-fade-out]="isTransitioning()"
    [class.card-fade-in]="!isTransitioning()"
    (animationend)="onCardAnimationEnd()">
    <!-- Sign In Form -->
    @if (!isCreateAccount()) {
      <div [class.sign-in-exit]="isCreateAccount()" [class.sign-in-enter]="!isCreateAccount()">
        <mat-card-header class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-8 mb-8 rounded-t-lg">
          <div class="flex flex-col">
            <mat-card-title class="text-3xl font-bold">Sign In</mat-card-title>
            <p class="text-indigo-100 text-sm mt-3 mb-3 font-light self-end">Your grocery list is waiting for you!</p>
          </div>
        </mat-card-header>

        <mat-card-content class="p-8">
          <form class="space-y-6" (submit)="handleSignIn($event)">
            <div class="flex flex-col">
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Email</mat-label>
                <input matInput type="email" [formField]="signInForm.email" placeholder="you@example.com">
              </mat-form-field>
              @if (signInForm.email().touched() && signInForm.email().invalid()) {
                @for (error of signInForm.email().errors(); track error) {
                  <mat-error class="text-sm pl-2">{{ error.message }}</mat-error>
                }
              }
            </div>

            <div class="flex flex-col">
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Password</mat-label>
                <input matInput type="password" [formField]="signInForm.password" placeholder="••••••••">
              </mat-form-field>
              @if (signInForm.password().touched() && signInForm.password().invalid()) {
                @for (error of signInForm.password().errors(); track error) {
                  <mat-error class="text-sm pl-2">{{ error.message }}</mat-error>
                }
              }
            </div>

            @if (signInError()) {
              <div class="bg-red-50 border border-red-200 rounded-md p-4">
                <p class="text-sm text-red-700">{{ signInError() }}</p>
              </div>
            }

            <!-- @if (signInTimeout()) {
              <div class="bg-red-50 border border-red-200 rounded-md p-4">
                <p class="text-sm text-grey-700">Your session has timed out. Please sign in again.</p>
              </div>
            } -->

            <div class="flex items-center justify-between pt-2">
              <mat-checkbox [formField]="signInForm.rememberMe" class="text-sm font-light">Remember me</mat-checkbox>
              <a href="#" class="text-sm text-indigo-600 hover:text-indigo-800 font-light transition-colors">Forgot password?</a>
            </div>

            <div class="flex flex-col gap-4 pt-4">
              <button mat-raised-button color="primary" type="submit"
                class="w-full py-3 text-lg font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                Sign In
              </button>
              <button mat-stroked-button type="button" class="w-full py-3 text-lg font-semibold text-indigo-600 border-indigo-600 hover:bg-indigo-50 transition-all duration-300 transform hover:scale-105" (click)="toggleCreateAccount()">
                Create Account
              </button>
            </div>
          </form>
        </mat-card-content>
      </div>
    }

    <!-- Create Account Form -->
    @if (isCreateAccount()) {
      <div [class.create-account-exit]="!isCreateAccount()" [class.create-account-enter]="isCreateAccount()">
        <mat-card-header class="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-8 mb-8 rounded-t-lg">
          <div class="flex flex-col">
            <mat-card-title class="text-3xl font-bold">Create Account</mat-card-title>
            <p class="text-purple-100 text-sm mt-3 mb-3 font-light self-end">Join us today!</p>
          </div>
        </mat-card-header>

        <mat-card-content class="p-8">
          <form class="space-y-6" (submit)="handleCreateAccount($event)">
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Name</mat-label>
              <input matInput type="text" [formField]="createAccountForm.name" placeholder="John Doe">
            </mat-form-field>
            @if (createAccountForm.name().touched() && createAccountForm.name().invalid()) {
                @for (error of createAccountForm.name().errors(); track error) {
                  <mat-error class="text-sm pl-2">{{ error.message }}</mat-error>
                }
            }

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Email</mat-label>
              <input matInput type="email" [formField]="createAccountForm.email" placeholder="you@example.com">
            </mat-form-field>
            @if (createAccountForm.email().touched() && createAccountForm.email().invalid()) {
                @for (error of createAccountForm.email().errors(); track error) {
                  <mat-error class="text-sm pl-2">{{ error.message }}</mat-error>
                }
            }

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Password</mat-label>
              <input matInput type="password" [formField]="createAccountForm.password" placeholder="••••••••">
            </mat-form-field>
            @if (createAccountForm.password().touched() && createAccountForm.password().invalid()) {
                @for (error of createAccountForm.password().errors(); track error) {
                  <mat-error class="text-sm pl-2">{{ error.message }}</mat-error>
                }
            }

            <div class="flex flex-col gap-4 pt-4">
              <button mat-raised-button color="primary" type="submit"
                class="w-full py-3 text-lg font-semibold hover:shadow-lg transition-all duration-300 transform hover:scale-105">
                Create Account
              </button>
              <button mat-stroked-button type="button" class="w-full py-3 text-lg font-semibold text-purple-600 border-purple-600 hover:bg-purple-50 transition-all duration-300 transform hover:scale-105" (click)="toggleCreateAccount()">
                Back to Sign In
              </button>
            </div>
          </form>
        </mat-card-content>
      </div>
    }
  </mat-card>
</div>
